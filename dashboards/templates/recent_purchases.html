{% load humanize %}
{% load vinoteca %}

{% if wine_count == 0 %}
  {% include "insufficient_wines.html" %}
{% else %}
<table class="responsive highlight">
  <thead>
    <tr>
      <th>Date</th>
      <th>Store</th>
      <th>Producer</th>
      <th>Region</th>
      <th>Name and Type</th>
      <th class="num-col">Price</th>
      <th class="num-col">Quantity</th>
    </tr>
  </thead>
  <tbody>
    {% for purchase in purchases %}
      <tr>
        <td>{{ purchase.date|inttodate|naturalday:"b j"|title }}</td>
        <td>{{ purchase.store.name }}</td>
        <td>
          {% if purchase.wine.producer %}
            <a href="{% url "Producers:Producer Profile" producer_id=purchase.wine.producer.id %}">
              {{ purchase.wine.producer.name }}
            </a>
          {% endif %}
        </td>
        <td>
          {% if purchase.wine.producer.region %}
            <a href="{% url "Region Profile" region_id=purchase.wine.producer.region.id %}">{{ purchase.wine.producer.region.name }}</a>
          {% endif %}
        </td>
        <td>
          <a href="{% url "Wines:Wine Profile" wine_id=purchase.wine.id %}">
            {{ purchase.wine.name|default_if_none:"" }}
          </a>
        </td>
        <td class="num-col">{{ purchase.price|floatformat:2|defndash }}</td>
        <td class="num-col">{{ purchase.quantity }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}
